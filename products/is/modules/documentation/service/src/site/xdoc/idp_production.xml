<!--
  ~ Copyright 2005-2007 WSO2, Inc. (http://wso2.com)
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
       "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-1"/>
    <title>Welcome to WSO2 Identity Server v2.0.0!</title>
    <link href="css/is-docs.css" rel="stylesheet"/>
   </head>
<body>
<h1>WSO2 Identity Solution, v@wso2is_version@ : Deploying Identity Provider in Production</h1>

<p>The identity provider by default comes configured with a simple sample and
can be used in the localhost to try all the samples. There are a set of 
configuration changes that one has to follow in deploying the Identity Provider
application in production.</p>
<p>These changes should be applied on a fresh identity provider instance. (i.e. 
Do not start the identity provider until the configurations are finalized)</p>


<h2>Step 1: Edit server configuration file</h2>

<p>Open wso2-identity-solution-@wso2is_version@/conf/server.xml file</p>

<p> This private  key is used for the HTTPS channel and for the token issuer to
sign the issued tokens. This information has to be changed in two files.
</p>

<p>Following section of the server.xml should be updated to match your privete key
information. The private key must be available in a keystore of type 
"JKS" or "PKCS12". For more information on keystores please see 
<a href="http://java.sun.com/j2se/1.4.2/docs/tooldocs/windows/keytool.html">here
</a>.</p>
<pre><![CDATA[

    <!--
      Security configurations
    -->
    <Security>
        <!--
            KeyStore which will be used for encrypting/decrypting passwords
            and other sensitive information.
        -->
        <KeyStore>
            <!-- Keystore file location-->
            <Location>${wso2wsas.home}/conf/wso2is.jks</Location>
            <!-- Keystore type (JKS/PKCS12 etc.)-->
            <Type>JKS</Type>
            <!-- Keystore password-->
            <Password>wso2is</Password>
            <!-- Private Key alias-->
            <KeyAlias>localhost</KeyAlias>
            <!-- Private Key password-->
            <KeyPassword>wso2is</KeyPassword>
        </KeyStore>

		
]]></pre>

<p>Also note that the host name of the Identity Provider must be changed to match 
the "Common Name" of the certificate of the private key.</p>

<pre><![CDATA[

    <!--
       Host name of the machine hosting this server
       e.g. www.wso2.org
    -->
    
    <HostName>www.foo.com</HostName>
    

]]></pre>

<p>The HTTP and HTTPS port also can be changed by chnaging the following 
configuration elements.</p>

<pre><![CDATA[

    <Ports>
        <HTTP>12080</HTTP>
        <HTTPS>12443</HTTPS>
    </Ports>

]]></pre>

<p>OpenID provider server url can be changed by changing the following
configuration element. Once this is set, OpenIDs will be generated in the
following format [OpenIDServerUrl]/user/[User Name].</p>
<p>e.g: http://localhost:12080/user/bob</p>
<pre><![CDATA[

    <OpenIDServerUrl>http://localhost:12080</OpenIDServerUrl>

]]></pre>

<h2>Step 2 : wso2-identity-solution-@wso2is_version@/conf/axis2.xml file</h2>

<p>The "transportReceiver" configurations of axis2.xml will have to be updated 
to match the keystore and ports setting changes.</p>


<pre><![CDATA[

    <transportReceiver name="http"
                       class="org.wso2.wsas.transport.http.HttpTransportListener">
        <parameter name="port">12080</parameter>
    </transportReceiver>

    <transportReceiver name="https"
                       class="org.wso2.wsas.transport.http.HttpsTransportListener">
        <parameter name="port">12443</parameter>
        <parameter name="sslProtocol">TLS</parameter>
        <parameter name="maxHttpHeaderSize">8192</parameter>
        <parameter name="maxThreads">150</parameter>
        <parameter name="minSpareThreads">25</parameter>
        <parameter name="maxSpareThreads">75</parameter>
        <parameter name="enableLookups">false</parameter>
        <parameter name="disableUploadTimeout">false</parameter>
        <parameter name="clientAuth">false</parameter>
        <parameter name="acceptCount">100</parameter>
        <parameter name="keystore">
            <wso2wsas:KeyStore xmlns:wso2wsas="http://www.wso2.org/products/wsas">
                <!-- Keystore file location-->
                <wso2wsas:Location>conf/wso2is.jks</wso2wsas:Location>
                <!-- Keystore type (JKS/PKCS12 etc.)-->
                <wso2wsas:Type>JKS</wso2wsas:Type>
                <!-- Keystore password-->
                <wso2wsas:Password>wso2is</wso2wsas:Password>
            </wso2wsas:KeyStore>
        </parameter>
    </transportReceiver>
]]></pre>

</body>
</html>
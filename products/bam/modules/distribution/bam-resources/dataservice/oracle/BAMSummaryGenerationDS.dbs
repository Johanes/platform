<?xml version="1.0" encoding="UTF-8"?>
<data name="BAMSummaryGenerationDS" emptyParamFix="true">
    <!--config id="bamDataSource">
        <property name="org.wso2.ws.dataservice.driver">org.h2.Driver</property>
        <property name="org.wso2.ws.dataservice.protocol">jdbc:h2:repository/database/WSO2BAM_DB</property>
        <property name="org.wso2.ws.dataservice.user">wso2bam</property>
        <property name="org.wso2.ws.dataservice.password">wso2bam</property>
        <property name="org.wso2.ws.dataservice.minpoolsize">5</property>
        <property name="org.wso2.ws.dataservice.maxpoolsize">20</property>
        <property name="org.wso2.ws.dataservice.autocommit">false</property>
    </config-->
    <!--config id="bamDataSource">
        <property name="org.wso2.ws.dataservice.driver">com.mysql.jdbc.Driver</property>
        <property name="org.wso2.ws.dataservice.protocol">jdbc:mysql://localhost:3306/wso2bam_db</property>
        <property name="org.wso2.ws.dataservice.user">wso2bam</property>
        <property name="org.wso2.ws.dataservice.password">wso2bam</property>
        <property name="org.wso2.ws.dataservice.minpoolsize">5</property>
        <property name="org.wso2.ws.dataservice.maxpoolsize">20</property>
        <property name="org.wso2.ws.dataservice.autocommit">false</property>
    </config-->
    <!--config id="bamDataSource">
        <property name="org.wso2.ws.dataservice.driver">com.microsoft.sqlserver.jdbc.SQLServerDriver</property>
        <property name="org.wso2.ws.dataservice.protocol">jdbc:sqlserver://10.100.1.200:1433;databaseName=wso2bam_db</property>
        <property name="org.wso2.ws.dataservice.user">wso2bam</property>
        <property name="org.wso2.ws.dataservice.password">wso2bam</property>
        <property name="org.wso2.ws.dataservice.minpoolsize">5</property>
        <property name="org.wso2.ws.dataservice.maxpoolsize">20</property>
        <property name="org.wso2.ws.dataservice.autocommit">false</property>
    </config-->
    <config id="bamDataSource">
        <property name="org.wso2.ws.dataservice.driver">oracle.jdbc.driver.OracleDriver</property>
        <property name="org.wso2.ws.dataservice.protocol">jdbc:oracle:thin:@10.100.1.10:1521/orcl</property>
        <property name="org.wso2.ws.dataservice.user">wso2carbon</property>
        <property name="org.wso2.ws.dataservice.password">wso2carbon</property>
        <property name="org.wso2.ws.dataservice.minpoolsize">5</property>
        <property name="org.wso2.ws.dataservice.maxpoolsize">20</property>
        <property name="org.wso2.ws.dataservice.autocommit">false</property>
    </config>
    <!--config id="bamDataSource">
        <property name="org.wso2.ws.dataservice.driver">org.h2.Driver</property>
        <property name="org.wso2.ws.dataservice.protocol">jdbc:h2:tcp://localhost/repository/database/WSO2BAM_DB</property>
        <property name="org.wso2.ws.dataservice.user">wso2bam</property>
        <property name="org.wso2.ws.dataservice.password">wso2bam</property>
        <property name="org.wso2.ws.dataservice.minpoolsize">5</property>
        <property name="org.wso2.ws.dataservice.maxpoolsize">20</property>
        <property name="org.wso2.ws.dataservice.autocommit">false</property>
    </config-->

    <!-- *********** -->
    <!-- DIMENSIONS  -->
    <!-- *********** -->

    <!-- YEAR -->
    <query id="addYearDimQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_YEAR_DIM (BAM_START_TIMESTAMP, BAM_NO) VALUES (?, ?)</sql>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="yearNo" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addYearDim">
        <call-query href="addYearDimQ">
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="yearNo" query-param="yearNo"/>
        </call-query>
    </operation>
    
    <query id="getYearDimQ" useConfig="bamDataSource">
        <sql>SELECT * FROM BAM_YEAR_DIM WHERE BAM_NO=? </sql>
        <param name="yearNo" sqlType="INTEGER" type=""/>
        <result element="yearDims" rowName="yearDim" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="bamId" column="BAM_ID"/>
            <element name="startTime" column="BAM_START_TIMESTAMP" xsdType="xs:dateTime"/>
            <element name="yearNo" column="BAM_NO"/>
        </result>
    </query>
    <operation name="getYearDim">
        <call-query href="getYearDimQ">
            <with-param name="yearNo" query-param="yearNo"/>
        </call-query>
    </operation>
    
    <query id="getYearDimFromIdQ" useConfig="bamDataSource">
        <sql>SELECT * FROM BAM_YEAR_DIM WHERE BAM_ID=? </sql>
        <param name="yearId" sqlType="INTEGER" type=""/>
        <result element="yearDims" rowName="yearDim" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="bamId" column="BAM_ID"/>
            <element name="startTime" column="BAM_START_TIMESTAMP" xsdType="xs:dateTime"/>
            <element name="yearNo" column="BAM_NO"/>
        </result>
    </query>
    <operation name="getYearDimFromId">
        <call-query href="getYearDimFromIdQ">
            <with-param name="yearId" query-param="yearId"/>
        </call-query>
    </operation>

    <!-- QUATER -->
    <query id="addQuarterDimQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_QTR_DIM (BAM_START_TIMESTAMP, BAM_NAME, BAM_NO, BAM_YEAR) VALUES (?, ?, ?, ?)</sql>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="name" sqlType="STRING" type=""/>
        <param name="quarterNo" sqlType="INTEGER" type=""/>
        <param name="yearId" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addQuarterDim">
        <call-query href="addQuarterDimQ">
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="name" query-param="name"/>
            <with-param name="quarterNo" query-param="quarterNo"/>
            <with-param name="yearId" query-param="yearId"/>
        </call-query>
    </operation>
    
    <query id="getQuarterDimQ" useConfig="bamDataSource">
        <sql>SELECT * FROM BAM_QTR_DIM WHERE BAM_NO=? AND BAM_YEAR=? </sql>
        <param name="quarterNo" sqlType="INTEGER" type=""/>
        <param name="yearId" sqlType="INTEGER" type=""/>
        <result element="quarterDims" rowName="quarterDim" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="bamId" column="BAM_ID"/>
            <element name="startTime" column="BAM_START_TIMESTAMP" xsdType="xs:dateTime"/>
            <element name="name" column="BAM_NAME"/>
            <element name="quarterNo" column="BAM_NO"/>
            <element name="yearId" column="BAM_YEAR"/>
        </result>
    </query>
    <operation name="getQuarterDim">
        <call-query href="getQuarterDimQ">
            <with-param name="quarterNo" query-param="quarterNo"/>
            <with-param name="yearId" query-param="yearId"/>
        </call-query>
    </operation>

    <query id="getQuarterDimFromIdQ" useConfig="bamDataSource">
        <sql>SELECT * FROM BAM_QTR_DIM WHERE BAM_ID=? </sql>
        <param name="quarterId" sqlType="INTEGER" type=""/>
        <result element="quarterDims" rowName="quarterDim" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="bamId" column="BAM_ID"/>
            <element name="startTime" column="BAM_START_TIMESTAMP" xsdType="xs:dateTime"/>
            <element name="name" column="BAM_NAME"/>
            <element name="quarterNo" column="BAM_NO"/>
            <element name="yearId" column="BAM_YEAR"/>
        </result>
    </query>
    <operation name="getQuarterDimFromId">
        <call-query href="getQuarterDimFromIdQ">
            <with-param name="quarterId" query-param="quarterId"/>
        </call-query>
    </operation>

    

    <!-- MONTH -->    
    <query id="addMonthDimQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_MONTH_DIM (BAM_START_TIMESTAMP, BAM_NAME, BAM_NO, BAM_QTR) VALUES (?, ?, ?, ?)</sql>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="name" sqlType="STRING" type=""/>
        <param name="monthNo" sqlType="INTEGER" type=""/>
        <param name="quarterId" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addMonthDim">
        <call-query href="addMonthDimQ">
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="name" query-param="name"/>
            <with-param name="monthNo" query-param="monthNo"/>
            <with-param name="quarterId" query-param="quarterId"/>
        </call-query>
    </operation>
    

    <query id="getMonthDimQ" useConfig="bamDataSource">
        <sql>SELECT * FROM BAM_MONTH_DIM WHERE BAM_NO=? AND BAM_QTR=? </sql>
        <param name="monthNo" sqlType="INTEGER" type=""/>
        <param name="quarterId" sqlType="INTEGER" type=""/>
        <result element="monthDims" rowName="monthDim" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="bamId" column="BAM_ID"/>
            <element name="startTime" column="BAM_START_TIMESTAMP" xsdType="xs:dateTime"/>
            <element name="name" column="BAM_NAME"/>
            <element name="monthNo" column="BAM_NO"/>
            <element name="quarterId" column="BAM_QTR"/>
        </result>
    </query>
    <operation name="getMonthDim">
        <call-query href="getMonthDimQ">
            <with-param name="monthNo" query-param="monthNo"/>
            <with-param name="quarterId" query-param="quarterId"/>
        </call-query>
    </operation>

    <query id="getMonthDimFormIdQ" useConfig="bamDataSource">
        <sql>SELECT * FROM BAM_MONTH_DIM WHERE BAM_ID=? </sql>
        <param name="monthId" sqlType="INTEGER" type=""/>
        <result element="monthDims" rowName="monthDim" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="bamId" column="BAM_ID"/>
            <element name="startTime" column="BAM_START_TIMESTAMP" xsdType="xs:dateTime"/>
            <element name="name" column="BAM_NAME"/>
            <element name="monthNo" column="BAM_NO"/>
            <element name="quarterId" column="BAM_QTR"/>
        </result>
    </query>
    <operation name="getMonthDimFormId">
        <call-query href="getMonthDimFormIdQ">
            <with-param name="monthId" query-param="monthId"/>
        </call-query>
    </operation>

    
    <!-- DAY -->    
    <query id="addDayDimQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_DAY_DIM (BAM_START_TIMESTAMP, BAM_NAME, BAM_DAY_OF_WEEK, BAM_DAY_OF_MONTH, BAM_DAY_OF_YEAR, BAM_MONTH) VALUES (?, ?, ?, ?, ?, ?)</sql>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="name" sqlType="STRING" type=""/>
        <param name="dayOfWeek" sqlType="INTEGER" type=""/>
        <param name="dayOfMonth" sqlType="INTEGER" type=""/>
        <param name="dayOfYear" sqlType="INTEGER" type=""/>
        <param name="monthId" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addDayDim">
        <call-query href="addDayDimQ">
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="name" query-param="name"/>
            <with-param name="dayOfWeek" query-param="dayOfWeek"/>
            <with-param name="dayOfMonth" query-param="dayOfMonth"/>
            <with-param name="dayOfYear" query-param="dayOfYear"/>
            <with-param name="monthId" query-param="monthId"/>
        </call-query>
    </operation>

    
    <query id="getDayDimQ" useConfig="bamDataSource">
        <sql>SELECT * FROM BAM_DAY_DIM WHERE BAM_DAY_OF_MONTH=? AND BAM_MONTH=? </sql>
        <param name="dayNo" sqlType="INTEGER" type=""/>
        <param name="monthId" sqlType="INTEGER" type=""/>
        <result element="dayDims" rowName="dayDim" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="bamId" column="BAM_ID"/>
            <element name="startTime" column="BAM_START_TIMESTAMP" xsdType="xs:dateTime"/>
            <element name="name" column="BAM_NAME"/>
            <element name="dayOfWeek" column="BAM_DAY_OF_WEEK"/>
            <element name="dayOfMonth" column="BAM_DAY_OF_MONTH"/>
            <element name="dayOfYear" column="BAM_DAY_OF_YEAR"/>
            <element name="monthId" column="BAM_MONTH"/>
        </result>
    </query>
    <operation name="getDayDim">
        <call-query href="getDayDimQ">
            <with-param name="dayNo" query-param="dayNo"/>
            <with-param name="monthId" query-param="monthId"/>
        </call-query>
    </operation>    


    <query id="getDayDimFromIdQ" useConfig="bamDataSource">
        <sql>SELECT * FROM BAM_DAY_DIM WHERE BAM_ID=? </sql>
        <param name="dayId" sqlType="INTEGER" type=""/>
        <result element="dayDims" rowName="dayDim" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="bamId" column="BAM_ID"/>
            <element name="startTime" column="BAM_START_TIMESTAMP" xsdType="xs:dateTime"/>
            <element name="name" column="BAM_NAME"/>
            <element name="dayOfWeek" column="BAM_DAY_OF_WEEK"/>
            <element name="dayOfMonth" column="BAM_DAY_OF_MONTH"/>
            <element name="dayOfYear" column="BAM_DAY_OF_YEAR"/>
            <element name="monthId" column="BAM_MONTH"/>
        </result>
    </query>
    <operation name="getDayDimFromId">
        <call-query href="getDayDimFromIdQ">
            <with-param name="dayId" query-param="dayId"/>
        </call-query>
    </operation>    
    
    
    <!-- HOUR -->    
    <query id="addHourDimQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_HOUR_DIM (BAM_START_TIMESTAMP, BAM_HOUR_NO, BAM_DAY) VALUES (?, ?, ?)</sql>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="hourNo" sqlType="INTEGER" type=""/>
        <param name="dayId" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addHourDim">
        <call-query href="addHourDimQ">
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="hourNo" query-param="hourNo"/>
            <with-param name="dayId" query-param="dayId"/>
        </call-query>
    </operation>
    
    
    <query id="getHourDimQ" useConfig="bamDataSource">
        <sql>SELECT * FROM BAM_HOUR_DIM WHERE BAM_HOUR_NO=? AND BAM_DAY=? </sql>
        <param name="hourNo" sqlType="INTEGER" type=""/>
        <param name="dayId" sqlType="INTEGER" type=""/>
        <result element="hourDims" rowName="hourDim" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="bamId" column="BAM_ID"/>
            <element name="startTime" column="BAM_START_TIMESTAMP" xsdType="xs:dateTime"/>
            <element name="hourNo" column="BAM_HOUR_NO"/>
            <element name="dayId" column="BAM_DAY"/>
        </result>
    </query>
    <operation name="getHourDim">
        <call-query href="getHourDimQ">
            <with-param name="hourNo" query-param="hourNo"/>
            <with-param name="dayId" query-param="dayId"/>
        </call-query>
    </operation>
    

    <query id="getHourDimFromIdQ" useConfig="bamDataSource">
        <sql>SELECT * FROM BAM_HOUR_DIM WHERE BAM_ID=? </sql>
        <param name="hourId" sqlType="INTEGER" type=""/>
        <result element="hourDims" rowName="hourDim" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="bamId" column="BAM_ID"/>
            <element name="startTime" column="BAM_START_TIMESTAMP" xsdType="xs:dateTime"/>
            <element name="hourNo" column="BAM_HOUR_NO"/>
            <element name="dayId" column="BAM_DAY"/>
        </result>
    </query>
    <operation name="getHourDimFromId">
        <call-query href="getHourDimFromIdQ">
            <with-param name="hourId" query-param="hourId"/>
        </call-query>
    </operation>
    
    
    
    <!-- ******************************* -->
    <!-- GET LATEST SERVER SUMMARY TIMES -->
    <!-- ******************************* -->
    <query id="getLatestServerStatHourlySummaryHourIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_HOUR_ID FROM BAM_SERVER_STAT_HOUR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_SERVER_STAT_HOUR_FACT WHERE BAM_SERVER_ID=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_HOUR_ID"/>
        </result>
    </query>
    <operation name="getLatestServerStatHourlySummaryHourId">
        <call-query href="getLatestServerStatHourlySummaryHourIdQ">
            <with-param name="serverId" query-param="serverId"/>
        </call-query>
    </operation>

    <query id="getLatestServerStatDailySummaryDayIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_DAY_ID FROM BAM_SERVER_STAT_DAY_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_SERVER_STAT_DAY_FACT WHERE BAM_SERVER_ID=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_DAY_ID"/>
        </result>
    </query>
    <operation name="getLatestServerStatDailySummaryDayId">
        <call-query href="getLatestServerStatDailySummaryDayIdQ">
            <with-param name="serverId" query-param="serverId"/>
        </call-query>
    </operation>    

    <query id="getLatestServerStatMonthlySummaryMonthIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_MONTH_ID FROM BAM_SERVER_STAT_MONTH_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_SERVER_STAT_MONTH_FACT WHERE BAM_SERVER_ID=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_MONTH_ID"/>
        </result>
    </query>
    <operation name="getLatestServerStatMonthlySummaryMonthId">
        <call-query href="getLatestServerStatMonthlySummaryMonthIdQ">
            <with-param name="serverId" query-param="serverId"/>
        </call-query>
    </operation>    
    
    <query id="getLatestServerStatQuarterlySummaryQuarterIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_QTR_ID FROM BAM_SERVER_STAT_QTR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_SERVER_STAT_QTR_FACT WHERE BAM_SERVER_ID=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_QTR_ID"/>
        </result>
    </query>
    <operation name="getLatestServerStatQuarterlySummaryQuarterId">
        <call-query href="getLatestServerStatQuarterlySummaryQuarterIdQ">
            <with-param name="serverId" query-param="serverId"/>
        </call-query>
    </operation>    

    <query id="getLatestServerStatYearlySummaryYearIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_YEAR_ID FROM BAM_SERVER_STAT_YEAR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_SERVER_STAT_YEAR_FACT WHERE BAM_SERVER_ID=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_YEAR_ID"/>
        </result>
    </query>
    <operation name="getLatestServerStatYearlySummaryYearId">
        <call-query href="getLatestServerStatYearlySummaryYearIdQ">
            <with-param name="serverId" query-param="serverId"/>
        </call-query>
    </operation>        


    <!-- ******************************** -->
    <!-- GET LATEST SERVICE SUMMARY TIMES -->
    <!-- ******************************** -->
    
    <query id="getLatestServiceStatHourlySummaryHourIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_HOUR_ID FROM BAM_SERVICE_STAT_HOUR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_SERVICE_STAT_HOUR_FACT WHERE BAM_SERVICE_ID=?)</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_HOUR_ID"/>
        </result>
    </query>
    <operation name="getLatestServiceStatHourlySummaryHourId">
        <call-query href="getLatestServiceStatHourlySummaryHourIdQ">
            <with-param name="serviceId" query-param="serviceId"/>
        </call-query>
    </operation>

    <query id="getLatestServiceStatDailySummaryDayIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_DAY_ID FROM BAM_SERVICE_STAT_DAY_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_SERVICE_STAT_DAY_FACT WHERE BAM_SERVICE_ID=?)</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_DAY_ID"/>
        </result>
    </query>
    <operation name="getLatestServiceStatDailySummaryDayId">
        <call-query href="getLatestServiceStatDailySummaryDayIdQ">
            <with-param name="serviceId" query-param="serviceId"/>
        </call-query>
    </operation>

    <query id="getLatestServiceStatMonthlySummaryMonthIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_MONTH_ID FROM BAM_SERVICE_STAT_MONTH_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_SERVICE_STAT_MONTH_FACT WHERE BAM_SERVICE_ID=?)</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_MONTH_ID"/>
        </result>
    </query>
    <operation name="getLatestServiceStatMonthlySummaryMonthId">
        <call-query href="getLatestServiceStatMonthlySummaryMonthIdQ">
            <with-param name="serviceId" query-param="serviceId"/>
        </call-query>
    </operation>

    <query id="getLatestServiceStatQuarterlySummaryQuarterIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_QTR_ID FROM BAM_SERVICE_STAT_QTR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_SERVICE_STAT_QTR_FACT WHERE BAM_SERVICE_ID=?)</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_QTR_ID"/>
        </result>
    </query>
    <operation name="getLatestServiceStatQuarterlySummaryQuarterId">
        <call-query href="getLatestServiceStatQuarterlySummaryQuarterIdQ">
            <with-param name="serviceId" query-param="serviceId"/>
        </call-query>
    </operation>

    <query id="getLatestServiceStatYearlySummaryYearIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_YEAR_ID FROM BAM_SERVICE_STAT_YEAR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_SERVICE_STAT_YEAR_FACT WHERE BAM_SERVICE_ID=?)</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_YEAR_ID"/>
        </result>
    </query>
    <operation name="getLatestServiceStatYearlySummaryYearId">
        <call-query href="getLatestServiceStatYearlySummaryYearIdQ">
            <with-param name="serviceId" query-param="serviceId"/>
        </call-query>
    </operation>

    <!-- ********************************** -->
    <!-- GET LATEST OPERATION SUMMARY TIMES -->
    <!-- ********************************** -->
    
    <query id="getLatestOperationStatHourlySummaryHourIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_HOUR_ID FROM BAM_OPERATION_STAT_HOUR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_OPERATION_STAT_HOUR_FACT WHERE BAM_OPERATION_ID=?)</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_HOUR_ID"/>
        </result>
    </query>
    <operation name="getLatestOperationStatHourlySummaryHourId">
        <call-query href="getLatestOperationStatHourlySummaryHourIdQ">
            <with-param name="operationId" query-param="operationId"/>
        </call-query>
    </operation>

    <query id="getLatestOperationStatDailySummaryDayIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_DAY_ID FROM BAM_OPERATION_STAT_DAY_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_OPERATION_STAT_DAY_FACT WHERE BAM_OPERATION_ID=?)</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_DAY_ID"/>
        </result>
    </query>
    <operation name="getLatestOperationStatDailySummaryDayId">
        <call-query href="getLatestOperationStatDailySummaryDayIdQ">
            <with-param name="operationId" query-param="operationId"/>
        </call-query>
    </operation>

    <query id="getLatestOperationStatMonthlySummaryMonthIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_MONTH_ID FROM BAM_OPERATION_STAT_MONTH_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_OPERATION_STAT_MONTH_FACT WHERE BAM_OPERATION_ID=?)</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_MONTH_ID"/>
        </result>
    </query>
    <operation name="getLatestOperationStatMonthlySummaryMonthId">
        <call-query href="getLatestOperationStatMonthlySummaryMonthIdQ">
            <with-param name="operationId" query-param="operationId"/>
        </call-query>
    </operation>

    <query id="getLatestOperationStatQuarterlySummaryQuarterIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_QTR_ID FROM BAM_OPERATION_STAT_QTR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_OPERATION_STAT_QTR_FACT WHERE BAM_OPERATION_ID=?)</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_QTR_ID"/>
        </result>
    </query>
    <operation name="getLatestOperationStatQuarterlySummaryQuarterId">
        <call-query href="getLatestOperationStatQuarterlySummaryQuarterIdQ">
            <with-param name="operationId" query-param="operationId"/>
        </call-query>
    </operation>

    <query id="getLatestOperationStatYearlySummaryYearIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_YEAR_ID FROM BAM_OPERATION_STAT_YEAR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_OPERATION_STAT_YEAR_FACT WHERE BAM_OPERATION_ID=?)</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_YEAR_ID"/>
        </result>
    </query>
    <operation name="getLatestOperationStatYearlySummaryYearId">
        <call-query href="getLatestOperationStatYearlySummaryYearIdQ">
            <with-param name="operationId" query-param="operationId"/>
        </call-query>
    </operation>
    

    
    
    <!-- ************************* -->
    <!-- SERVER SUMMARY GENERATION -->
    <!-- ************************* -->
    <!--query id="getServerHourlySummary_newQ" useConfig="bamDataSource">
        <sql>SELECT AVG( BAM_AVG_RES_TIME ) AS AVG_RES , MAX( BAM_MAX_RES_TIME ) AS MAX_RES , MIN( BAM_MIN_RES_TIME ) AS MIN_RES, 
            (SELECT MAX( BAM_CUM_REQ_COUNT FROM BAM_SERVER_DATA WHERE BAM_SERVER_ID = :serverId AND BAM_TIMESTAMP &gt; :prevStartTimestamp AND BAM_TIMESTAMP &lt; :startTimestamp )) - (SELECT MAX( BAM_CUM_REQ_COUNT FROM BAM_SERVER_DATA WHERE BAM_SERVER_ID = :serverId AND BAM_TIMESTAMP &gt; :startTimestamp AND BAM_TIMESTAMP &lt; :endTimestamp )) AS REQ_COUNT, 
            (SELECT MAX( BAM_CUM_RES_COUNT FROM BAM_SERVER_DATA WHERE BAM_SERVER_ID = :serverId AND BAM_TIMESTAMP &gt; :prevStartTimestamp AND BAM_TIMESTAMP &lt; :startTimestamp )) - (SELECT MAX( BAM_CUM_RES_COUNT FROM BAM_SERVER_DATA WHERE BAM_SERVER_ID = :serverId AND BAM_TIMESTAMP &gt; :startTimestamp AND BAM_TIMESTAMP &lt; :endTimestamp )) AS RES_COUNT, 
            (SELECT MAX( BAM_CUM_FAULT_COUNT FROM BAM_SERVER_DATA WHERE BAM_SERVER_ID = :serverId AND BAM_TIMESTAMP &gt; :prevStartTimestamp AND BAM_TIMESTAMP &lt; :startTimestamp )) - (SELECT MAX( BAM_CUM_FAULT_COUNT FROM BAM_SERVER_DATA WHERE BAM_SERVER_ID = :serverId AND BAM_TIMESTAMP &gt; :startTimestamp AND BAM_TIMESTAMP &lt; :endTimestamp )) AS FAULT_COUNT, 
            FROM BAM_SERVER_DATA WHERE BAM_SERVER_ID = :serverId AND BAM_TIMESTAMP &gt; :startTimestamp AND BAM_TIMESTAMP &lt; :endTimestamp</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="prevStartTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query-->
    
    <query id="getServerDataMaxCountsQ" useConfig="bamDataSource">
        <!--sql>SELECT MAX( BAM_CUM_REQ_COUNT ) AS REQ_COUNT, MAX( BAM_CUM_RES_COUNT ) AS RES_COUNT, MAX( BAM_CUM_FAULT_COUNT ) AS FAULT_COUNT FROM BAM_SERVER_DATA WHERE BAM_SERVER_ID =? AND BAM_TIMESTAMP &gt; ? AND BAM_TIMESTAMP &lt; ?</sql-->
        <sql>SELECT MAX( BAM_CUM_REQ_COUNT ) AS REQ_COUNT, MAX( BAM_CUM_RES_COUNT ) AS RES_COUNT, MAX( BAM_CUM_FAULT_COUNT ) AS FAULT_COUNT FROM BAM_SERVER_DATA WHERE BAM_SERVER_ID =? AND BAM_TIMESTAMP &gt; ? AND BAM_TIMESTAMP &lt; ?</sql>
        <param name="serverId" sqlType="INTEGER" />
        <param name="startTimestamp" sqlType="TIMESTAMP" />
        <param name="endTimestamp" sqlType="TIMESTAMP" />
        <result element="maxCounts"  rowName="maxCount" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getServerDataMaxCounts">
        <call-query href="getServerDataMaxCountsQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>



    <query id="getServerHourlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG( BAM_AVG_RES_TIME ) AS AVG_RES , MAX( BAM_MAX_RES_TIME ) AS MAX_RES , MIN( BAM_MIN_RES_TIME ) AS MIN_RES, MAX( BAM_CUM_REQ_COUNT ) - MIN( BAM_CUM_REQ_COUNT ) AS REQ_COUNT, MAX( BAM_CUM_RES_COUNT ) - MIN( BAM_CUM_RES_COUNT ) AS RES_COUNT, MAX( BAM_CUM_FAULT_COUNT ) - MIN( BAM_CUM_FAULT_COUNT ) AS FAULT_COUNT FROM BAM_SERVER_DATA WHERE BAM_SERVER_ID =? AND BAM_TIMESTAMP &gt; ? AND BAM_TIMESTAMP &lt; ?</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getServerHourlySummary">
        <call-query href="getServerHourlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>

    <query id="deleteServerDataQ" useConfig="bamDataSource">
        <sql>DELETE FROM BAM_SERVER_DATA WHERE BAM_SERVER_ID =? AND BAM_TIMESTAMP &gt; ? AND BAM_TIMESTAMP &lt; ?</sql> 
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
    </query>
    <operation name="deleteServerData">
        <call-query href="deleteServerDataQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>


    <query id="addServerStatHourlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_SERVER_STAT_HOUR_FACT (BAM_SERVER_ID, BAM_HOUR_ID, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_RES_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="hourId" sqlType="INTEGER" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="resCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addServerStatHourlySummary">
        <call-query href="addServerStatHourlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="hourId" query-param="hourId"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="resCount" query-param="resCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>
    
    <query id="getServerDailySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_RES_COUNT) AS RES_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_SERVER_STAT_HOUR_FACT WHERE BAM_SERVER_ID=? AND BAM_HOUR_ID IN (SELECT BAM_ID FROM BAM_HOUR_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getServerDailySummary">
        <call-query href="getServerDailySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>    
    
    <query id="addServerStatDailySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_SERVER_STAT_DAY_FACT (BAM_SERVER_ID, BAM_DAY_ID, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_RES_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="dayId" sqlType="INTEGER" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="resCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addServerStatDailySummary">
        <call-query href="addServerStatDailySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="dayId" query-param="dayId"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="resCount" query-param="resCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>    
    
    
    <query id="getServerMonthlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_RES_COUNT) AS RES_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_SERVER_STAT_DAY_FACT WHERE BAM_SERVER_ID=? AND BAM_DAY_ID IN (SELECT BAM_ID FROM BAM_DAY_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getServerMonthlySummary">
        <call-query href="getServerMonthlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>    
    
    <query id="addServerStatMonthlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_SERVER_STAT_MONTH_FACT (BAM_SERVER_ID, BAM_MONTH_ID, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_RES_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="monthId" sqlType="INTEGER" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="resCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addServerStatMonthlySummary">
        <call-query href="addServerStatMonthlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="monthId" query-param="monthId"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="resCount" query-param="resCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>    

    <query id="getServerQuarterlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_RES_COUNT) AS RES_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_SERVER_STAT_MONTH_FACT WHERE BAM_SERVER_ID=? AND BAM_MONTH_ID IN (SELECT BAM_ID FROM BAM_MONTH_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getServerQuarterlySummary">
        <call-query href="getServerQuarterlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>    
    
    <query id="addServerStatQuarterlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_SERVER_STAT_QTR_FACT (BAM_SERVER_ID, BAM_QTR_ID, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_RES_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="quarterId" sqlType="INTEGER" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="resCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addServerStatQuarterlySummary">
        <call-query href="addServerStatQuarterlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="quarterId" query-param="quarterId"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="resCount" query-param="resCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>    

    
    <query id="getServerYearlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_RES_COUNT) AS RES_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_SERVER_STAT_QTR_FACT WHERE BAM_SERVER_ID=? AND BAM_QTR_ID IN (SELECT BAM_ID FROM BAM_QTR_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getServerYearlySummary">
        <call-query href="getServerYearlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>    
    
    <query id="addServerStatYearlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_SERVER_STAT_YEAR_FACT (BAM_SERVER_ID, BAM_YEAR_ID, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_RES_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="yearId" sqlType="INTEGER" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="resCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addServerStatYearlySummary">
        <call-query href="addServerStatYearlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="yearId" query-param="yearId"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="resCount" query-param="resCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>

    <!-- ************************** -->
    <!-- SERVICE SUMMARY GENERATION -->
    <!-- ************************** -->

    <query id="getServiceDataMaxCountsQ" useConfig="bamDataSource">
        <sql>SELECT MAX( BAM_CUM_REQ_COUNT ) AS REQ_COUNT, MAX( BAM_CUM_RES_COUNT ) AS RES_COUNT, MAX( BAM_CUM_FAULT_COUNT ) AS FAULT_COUNT FROM BAM_SERVICE_DATA WHERE BAM_SERVICE_ID =? AND BAM_TIMESTAMP &gt; ? AND BAM_TIMESTAMP &lt; ?</sql>
        <param name="serviceId" sqlType="INTEGER" />
        <param name="startTimestamp" sqlType="TIMESTAMP" />
        <param name="endTimestamp" sqlType="TIMESTAMP" />
        <result element="maxCounts"  rowName="maxCount" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getServiceDataMaxCounts">
        <call-query href="getServiceDataMaxCountsQ">
            <with-param name="serviceId" query-param="serviceId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>

 
    <query id="getServiceHourlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG( BAM_AVG_RES_TIME ) AS AVG_RES , MAX( BAM_MAX_RES_TIME ) AS MAX_RES , MIN( BAM_MIN_RES_TIME ) AS MIN_RES, MAX( BAM_CUM_REQ_COUNT ) - MIN( BAM_CUM_REQ_COUNT ) AS REQ_COUNT, MAX( BAM_CUM_RES_COUNT ) - MIN( BAM_CUM_RES_COUNT ) AS RES_COUNT, MAX( BAM_CUM_FAULT_COUNT ) - MIN( BAM_CUM_FAULT_COUNT ) AS FAULT_COUNT FROM BAM_SERVICE_DATA WHERE BAM_SERVICE_ID =? AND BAM_TIMESTAMP &gt; ? AND BAM_TIMESTAMP &lt; ?</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getServiceHourlySummary">
        <call-query href="getServiceHourlySummaryQ">
            <with-param name="serviceId" query-param="serviceId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>

    <query id="deleteServiceDataQ" useConfig="bamDataSource">
        <sql>DELETE FROM BAM_SERVICE_DATA WHERE BAM_SERVICE_ID=? AND BAM_TIMESTAMP &gt; ? AND BAM_TIMESTAMP &lt; ?</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
    </query>
    <operation name="deleteServiceData">
        <call-query href="deleteServiceDataQ">
            <with-param name="serviceId" query-param="serviceId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>


    <query id="addServiceStatHourlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_SERVICE_STAT_HOUR_FACT (BAM_SERVICE_ID, BAM_HOUR_ID, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_RES_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <param name="hourId" sqlType="INTEGER" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="resCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addServiceStatHourlySummary">
        <call-query href="addServiceStatHourlySummaryQ">
            <with-param name="serviceId" query-param="serviceId"/>
            <with-param name="hourId" query-param="hourId"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="resCount" query-param="resCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>
    
    <query id="getServiceDailySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_RES_COUNT) AS RES_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_SERVICE_STAT_HOUR_FACT WHERE BAM_SERVICE_ID=? AND BAM_HOUR_ID IN (SELECT BAM_ID FROM BAM_HOUR_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getServiceDailySummary">
        <call-query href="getServiceDailySummaryQ">
            <with-param name="serviceId" query-param="serviceId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>    
    
    <query id="addServiceStatDailySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_SERVICE_STAT_DAY_FACT (BAM_SERVICE_ID, BAM_DAY_ID, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_RES_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <param name="dayId" sqlType="INTEGER" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="resCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addServiceStatDailySummary">
        <call-query href="addServiceStatDailySummaryQ">
            <with-param name="serviceId" query-param="serviceId"/>
            <with-param name="dayId" query-param="dayId"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="resCount" query-param="resCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>    
    
    
    <query id="getServiceMonthlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_RES_COUNT) AS RES_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_SERVICE_STAT_DAY_FACT WHERE BAM_SERVICE_ID=? AND BAM_DAY_ID IN (SELECT BAM_ID FROM BAM_DAY_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getServiceMonthlySummary">
        <call-query href="getServiceMonthlySummaryQ">
            <with-param name="serviceId" query-param="serviceId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>    
    
    <query id="addServiceStatMonthlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_SERVICE_STAT_MONTH_FACT (BAM_SERVICE_ID, BAM_MONTH_ID, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_RES_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <param name="monthId" sqlType="INTEGER" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="resCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addServiceStatMonthlySummary">
        <call-query href="addServiceStatMonthlySummaryQ">
            <with-param name="serviceId" query-param="serviceId"/>
            <with-param name="monthId" query-param="monthId"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="resCount" query-param="resCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>    

    <query id="getServiceQuarterlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_RES_COUNT) AS RES_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_SERVICE_STAT_MONTH_FACT WHERE BAM_SERVICE_ID=? AND BAM_MONTH_ID IN (SELECT BAM_ID FROM BAM_MONTH_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getServiceQuarterlySummary">
        <call-query href="getServiceQuarterlySummaryQ">
            <with-param name="serviceId" query-param="serviceId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>    
    
    <query id="addServiceStatQuarterlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_SERVICE_STAT_QTR_FACT (BAM_SERVICE_ID, BAM_QTR_ID, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_RES_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <param name="quarterId" sqlType="INTEGER" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="resCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addServiceStatQuarterlySummary">
        <call-query href="addServiceStatQuarterlySummaryQ">
            <with-param name="serviceId" query-param="serviceId"/>
            <with-param name="quarterId" query-param="quarterId"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="resCount" query-param="resCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>    

    
    <query id="getServiceYearlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_RES_COUNT) AS RES_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_SERVICE_STAT_QTR_FACT WHERE BAM_SERVICE_ID=? AND BAM_QTR_ID IN (SELECT BAM_ID FROM BAM_QTR_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getServiceYearlySummary">
        <call-query href="getServiceYearlySummaryQ">
            <with-param name="serviceId" query-param="serviceId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>    
    
    <query id="addServiceStatYearlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_SERVICE_STAT_YEAR_FACT (BAM_SERVICE_ID, BAM_YEAR_ID, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_RES_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serviceId" sqlType="INTEGER" type=""/>
        <param name="yearId" sqlType="INTEGER" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="resCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addServiceStatYearlySummary">
        <call-query href="addServiceStatYearlySummaryQ">
            <with-param name="serviceId" query-param="serviceId"/>
            <with-param name="yearId" query-param="yearId"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="resCount" query-param="resCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>
    
    <!-- **************************** -->
    <!-- OPERATION SUMMARY GENERATION -->
    <!-- **************************** -->
    
    <query id="getOperationDataMaxCountsQ" useConfig="bamDataSource">
        <sql>SELECT MAX( BAM_CUM_REQ_COUNT ) AS REQ_COUNT, MAX( BAM_CUM_RES_COUNT ) AS RES_COUNT, MAX( BAM_CUM_FAULT_COUNT ) AS FAULT_COUNT FROM BAM_OPERATION_DATA WHERE BAM_OPERATION_ID = ? AND BAM_TIMESTAMP &gt; ? AND BAM_TIMESTAMP &lt; ?</sql>
        <param name="operationId" sqlType="INTEGER" />
        <param name="startTimestamp" sqlType="TIMESTAMP" />
        <param name="endTimestamp" sqlType="TIMESTAMP" />
        <result element="maxCounts"  rowName="maxCount" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getOperationDataMaxCounts">
        <call-query href="getOperationDataMaxCountsQ">
            <with-param name="operationId" query-param="operationId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>

 
    <query id="getOperationHourlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG( BAM_AVG_RES_TIME ) AS AVG_RES , MAX( BAM_MAX_RES_TIME ) AS MAX_RES , MIN( BAM_MIN_RES_TIME ) AS MIN_RES, MAX( BAM_CUM_REQ_COUNT ) - MIN( BAM_CUM_REQ_COUNT ) AS REQ_COUNT, MAX( BAM_CUM_RES_COUNT ) - MIN( BAM_CUM_RES_COUNT ) AS RES_COUNT, MAX( BAM_CUM_FAULT_COUNT ) - MIN( BAM_CUM_FAULT_COUNT ) AS FAULT_COUNT FROM BAM_OPERATION_DATA WHERE BAM_OPERATION_ID =? AND BAM_TIMESTAMP &gt; ? AND BAM_TIMESTAMP &lt; ?</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getOperationHourlySummary">
        <call-query href="getOperationHourlySummaryQ">
            <with-param name="operationId" query-param="operationId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>

    <query id="deleteOperationDataQ" useConfig="bamDataSource">
        <sql>DELETE FROM BAM_OPERATION_DATA WHERE BAM_OPERATION_ID =? AND BAM_TIMESTAMP &gt; ? AND BAM_TIMESTAMP &lt; ?</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
    </query>
    <operation name="deleteOperationData">
        <call-query href="deleteOperationDataQ">
            <with-param name="operationId" query-param="operationId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>


    <query id="addOperationStatHourlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_OPERATION_STAT_HOUR_FACT (BAM_OPERATION_ID, BAM_HOUR_ID, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_RES_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <param name="hourId" sqlType="INTEGER" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="resCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addOperationStatHourlySummary">
        <call-query href="addOperationStatHourlySummaryQ">
            <with-param name="operationId" query-param="operationId"/>
            <with-param name="hourId" query-param="hourId"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="resCount" query-param="resCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>
    
    <query id="getOperationDailySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_RES_COUNT) AS RES_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_OPERATION_STAT_HOUR_FACT WHERE BAM_OPERATION_ID=? AND BAM_HOUR_ID IN (SELECT BAM_ID FROM BAM_HOUR_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getOperationDailySummary">
        <call-query href="getOperationDailySummaryQ">
            <with-param name="operationId" query-param="operationId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>    
    
    <query id="addOperationStatDailySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_OPERATION_STAT_DAY_FACT (BAM_OPERATION_ID, BAM_DAY_ID, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_RES_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <param name="dayId" sqlType="INTEGER" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="resCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addOperationStatDailySummary">
        <call-query href="addOperationStatDailySummaryQ">
            <with-param name="operationId" query-param="operationId"/>
            <with-param name="dayId" query-param="dayId"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="resCount" query-param="resCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>    
    
    
    <query id="getOperationMonthlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_RES_COUNT) AS RES_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_OPERATION_STAT_DAY_FACT WHERE BAM_OPERATION_ID=? AND BAM_DAY_ID IN (SELECT BAM_ID FROM BAM_DAY_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getOperationMonthlySummary">
        <call-query href="getOperationMonthlySummaryQ">
            <with-param name="operationId" query-param="operationId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>    
    
    <query id="addOperaionStatMonthlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_OPERATION_STAT_MONTH_FACT (BAM_OPERATION_ID, BAM_MONTH_ID, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_RES_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <param name="monthId" sqlType="INTEGER" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="resCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addOperaionStatMonthlySummary">
        <call-query href="addOperaionStatMonthlySummaryQ">
            <with-param name="operationId" query-param="operationId"/>
            <with-param name="monthId" query-param="monthId"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="resCount" query-param="resCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>    

    <query id="getOperationQuarterlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_RES_COUNT) AS RES_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_OPERATION_STAT_MONTH_FACT WHERE BAM_OPERATION_ID=? AND BAM_MONTH_ID IN (SELECT BAM_ID FROM BAM_MONTH_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getOperationQuarterlySummary">
        <call-query href="getOperationQuarterlySummaryQ">
            <with-param name="operationId" query-param="operationId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>    
    
    <query id="addOperationStatQuarterlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_OPERATION_STAT_QTR_FACT (BAM_OPERATION_ID, BAM_QTR_ID, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_RES_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <param name="quarterId" sqlType="INTEGER" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="resCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addOperationStatQuarterlySummary">
        <call-query href="addOperationStatQuarterlySummaryQ">
            <with-param name="operationId" query-param="operationId"/>
            <with-param name="quarterId" query-param="quarterId"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="resCount" query-param="resCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>    

    
    <query id="getOperationYearlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_RES_COUNT) AS RES_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_OPERATION_STAT_QTR_FACT WHERE BAM_OPERATION_ID=? AND BAM_QTR_ID IN (SELECT BAM_ID FROM BAM_QTR_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="summaryStats"  rowName="summaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="resCount" column="RES_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getOperationYearlySummary">
        <call-query href="getOperationYearlySummaryQ">
            <with-param name="operationId" query-param="operationId"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>    
    
    <query id="addOperationStatYearlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_OPERATION_STAT_YEAR_FACT (BAM_OPERATION_ID, BAM_YEAR_ID, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_RES_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="operationId" sqlType="INTEGER" type=""/>
        <param name="yearId" sqlType="INTEGER" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="resCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addOperationStatYearlySummary">
        <call-query href="addOperationStatYearlySummaryQ">
            <with-param name="operationId" query-param="operationId"/>
            <with-param name="yearId" query-param="yearId"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="resCount" query-param="resCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>


    <!-- ******************************************* -->
    <!-- *************** ENDPOINT ****************** -->
    <!-- ******************************************* -->
    
    <!-- getLatest* =============================================================== -->
    
    <query id="getLatestEndpointStatHourlySummaryHourIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_HOUR_ID FROM BAM_ENDPOINT_STAT_HOUR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_ENDPOINT_STAT_HOUR_FACT WHERE BAM_SERVER_ID=? AND BAM_ENDPOINT_NAME=? AND BAM_DIRECTION=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="endpointName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_HOUR_ID"/>
        </result>
    </query>
    <operation name="getLatestEndpointStatHourlySummaryHourId">
        <call-query href="getLatestEndpointStatHourlySummaryHourIdQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="endpointName" query-param="endpointName"/>
            <with-param name="direction" query-param="direction"/>
        </call-query>
    </operation>
    
    <query id="getLatestEndpointStatDailySummaryDayIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_DAY_ID FROM BAM_ENDPOINT_STAT_DAY_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_ENDPOINT_STAT_DAY_FACT WHERE BAM_SERVER_ID=? AND BAM_ENDPOINT_NAME=? AND BAM_DIRECTION=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="endpointName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_DAY_ID"/>
        </result>
    </query>
    <operation name="getLatestEndpointStatDailySummaryDayId">
        <call-query href="getLatestEndpointStatDailySummaryDayIdQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="endpointName" query-param="endpointName"/>
            <with-param name="direction" query-param="direction"/>
        </call-query>
    </operation>

    <query id="getLatestEndpointStatMonthlySummaryMonthIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_MONTH_ID FROM BAM_ENDPOINT_STAT_MONTH_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_ENDPOINT_STAT_MONTH_FACT WHERE BAM_SERVER_ID=? AND BAM_ENDPOINT_NAME=? AND BAM_DIRECTION=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="endpointName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_MONTH_ID"/>
        </result>
    </query>
    <operation name="getLatestEndpointStatMonthlySummaryMonthId">
        <call-query href="getLatestEndpointStatMonthlySummaryMonthIdQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="endpointName" query-param="endpointName"/>
            <with-param name="direction" query-param="direction"/>
        </call-query>
    </operation>
    
    <query id="getLatestEndpointStatQuarterlySummaryQuarterIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_QTR_ID FROM BAM_ENDPOINT_STAT_QTR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_ENDPOINT_STAT_QTR_FACT WHERE BAM_SERVER_ID=? AND BAM_ENDPOINT_NAME=? AND BAM_DIRECTION=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="endpointName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_QTR_ID"/>
        </result>
    </query>
    <operation name="getLatestEndpointStatQuarterlySummaryQuarterId">
        <call-query href="getLatestEndpointStatQuarterlySummaryQuarterIdQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="endpointName" query-param="endpointName"/>
            <with-param name="direction" query-param="direction"/>
        </call-query>
    </operation>
    
    <query id="getLatestEndpointStatYearlySummaryYearIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_YEAR_ID FROM BAM_ENDPOINT_STAT_YEAR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_ENDPOINT_STAT_YEAR_FACT WHERE BAM_SERVER_ID=? AND BAM_ENDPOINT_NAME=? AND BAM_DIRECTION=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="endpointName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_YEAR_ID"/>
        </result>
    </query>
    <operation name="getLatestEndpointStatYearlySummaryYearId">
        <call-query href="getLatestEndpointStatYearlySummaryYearIdQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="endpointName" query-param="endpointName"/>
            <with-param name="direction" query-param="direction"/>
        </call-query>
    </operation>

    
<!-- summary gen for hour =============================================================== -->
    
    <query id="getDataForMediationHourlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT BAM_VALUE FROM BAM_SERVER_USER_DATA WHERE BAM_SERVER_ID=? AND BAM_KEY=? AND BAM_TIMESTAMP  &gt;=? AND BAM_TIMESTAMP &lt;=?</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="endpointName" sqlType="STRING" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="medStatValues"  rowName="medStatValue" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="medStatValue" column="BAM_VALUE"/>
        </result>
    </query>
    <operation name="getDataForMediationHourlySummary">
        <call-query href="getDataForMediationHourlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="endpointName" query-param="endpointName"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>

    <query id="getDataForMediationMaxCountQ" useConfig="bamDataSource">
        <sql>SELECT BAM_VALUE FROM BAM_SERVER_USER_DATA WHERE BAM_SERVER_ID=? AND BAM_KEY=? AND BAM_TIMESTAMP &gt; ? AND BAM_TIMESTAMP &lt;=?</sql>
        <param name="serverId" sqlType="INTEGER"/>
        <param name="mediationName" sqlType="STRING"/>
        <param name="startTimestamp" sqlType="TIMESTAMP"/>
        <param name="endTimestamp" sqlType="TIMESTAMP"/>
        <result element="medStatValues"  rowName="medStatValue" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="medStatValue" column="BAM_VALUE"/>
        </result>
    </query>
    <operation name="getDataForMediationMaxCount">
        <call-query href="getDataForMediationMaxCountQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="mediationName" query-param="mediationName"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>

    <query id="deleteServerUserDataQ" useConfig="bamDataSource">
        <sql>DELETE FROM BAM_SERVER_USER_DATA WHERE BAM_SERVER_ID=? AND BAM_KEY=? AND BAM_TIMESTAMP  &gt;=? AND BAM_TIMESTAMP &lt;=?</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="name" sqlType="STRING" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
    </query>
    <operation name="deleteServerUserData">
        <call-query href="deleteServerUserDataQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="name" query-param="name"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>

    <query id="addEndpointStatHourlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_ENDPOINT_STAT_HOUR_FACT (BAM_SERVER_ID, BAM_HOUR_ID, BAM_ENDPOINT_NAME, BAM_DIRECTION, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="hourId" sqlType="INTEGER" type=""/>
        <param name="endpointName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addEndpointStatHourlySummary">
        <call-query href="addEndpointStatHourlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="hourId" query-param="hourId"/>
            <with-param name="endpointName" query-param="endpointName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>    
    
<!-- summary gen for day, month, quarter and year =============================================================== -->
    <!-- TODO: this name should change to something like calcEndpointStatDailySummaryQ -->
    <query id="getEndpointStatDailySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_ENDPOINT_STAT_HOUR_FACT WHERE BAM_SERVER_ID=? AND BAM_ENDPOINT_NAME=? AND BAM_DIRECTION=? AND BAM_HOUR_ID IN (SELECT BAM_ID FROM BAM_HOUR_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="endpointName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="medSummaryStats"  rowName="medSummaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getEndpointStatDailySummary">
        <call-query href="getEndpointStatDailySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="endpointName" query-param="endpointName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>
    
    <query id="addEndpointStatDailySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_ENDPOINT_STAT_DAY_FACT (BAM_SERVER_ID, BAM_DAY_ID, BAM_ENDPOINT_NAME, BAM_DIRECTION, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="dayId" sqlType="INTEGER" type=""/>
        <param name="endpointName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addEndpointStatDailySummary">
        <call-query href="addEndpointStatDailySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="dayId" query-param="dayId"/>
            <with-param name="endpointName" query-param="endpointName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>    

    <query id="getEndpointStatMonthlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_ENDPOINT_STAT_DAY_FACT WHERE BAM_SERVER_ID=? AND BAM_ENDPOINT_NAME=? AND BAM_DIRECTION=? AND BAM_DAY_ID IN (SELECT BAM_ID FROM BAM_DAY_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="endpointName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="medSummaryStats"  rowName="medSummaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getEndpointStatMonthlySummary">
        <call-query href="getEndpointStatMonthlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="endpointName" query-param="endpointName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>
    
    <query id="addEndpointStatMonthlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_ENDPOINT_STAT_MONTH_FACT (BAM_SERVER_ID, BAM_MONTH_ID, BAM_ENDPOINT_NAME, BAM_DIRECTION, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="monthId" sqlType="INTEGER" type=""/>
        <param name="endpointName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addEndpointStatMonthlySummary">
        <call-query href="addEndpointStatMonthlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="monthId" query-param="monthId"/>
            <with-param name="endpointName" query-param="endpointName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>        
    
    <query id="getEndpointStatQuarterlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_ENDPOINT_STAT_MONTH_FACT WHERE BAM_SERVER_ID=? AND BAM_ENDPOINT_NAME=? AND BAM_DIRECTION=? AND BAM_MONTH_ID IN (SELECT BAM_ID FROM BAM_MONTH_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="endpointName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="medSummaryStats"  rowName="medSummaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getEndpointStatQuarterlySummary">
        <call-query href="getEndpointStatQuarterlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="endpointName" query-param="endpointName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>
    
    <query id="addEndpointStatQuarterlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_ENDPOINT_STAT_QTR_FACT (BAM_SERVER_ID, BAM_QTR_ID, BAM_ENDPOINT_NAME, BAM_DIRECTION, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="quarterId" sqlType="INTEGER" type=""/>
        <param name="endpointName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addEndpointStatQuarterlySummary">
        <call-query href="addEndpointStatQuarterlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="quarterId" query-param="quarterId"/>
            <with-param name="endpointName" query-param="endpointName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>        

    <query id="getEndpointStatYearlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_ENDPOINT_STAT_QTR_FACT WHERE BAM_SERVER_ID=? AND BAM_ENDPOINT_NAME=? AND BAM_DIRECTION=? AND BAM_QTR_ID IN (SELECT BAM_ID FROM BAM_QTR_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="endpointName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="medSummaryStats"  rowName="medSummaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getEndpointStatYearlySummary">
        <call-query href="getEndpointStatYearlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="endpointName" query-param="endpointName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>
    
    <query id="addEndpointStatYearlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_ENDPOINT_STAT_YEAR_FACT (BAM_SERVER_ID, BAM_YEAR_ID, BAM_ENDPOINT_NAME, BAM_DIRECTION, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="yearId" sqlType="INTEGER" type=""/>
        <param name="endpointName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addEndpointStatYearlySummary">
        <call-query href="addEndpointStatYearlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="yearId" query-param="yearId"/>
            <with-param name="endpointName" query-param="endpointName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>
    


    <!-- ******************************************* -->
    <!-- ***************** PROXY ******************* -->
    <!-- ******************************************* -->

    <query id="getLatestProxyStatHourlySummaryHourIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_HOUR_ID FROM BAM_PROXY_STAT_HOUR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_PROXY_STAT_HOUR_FACT WHERE BAM_SERVER_ID=? AND BAM_PROXY_NAME=? AND BAM_DIRECTION=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="proxyName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_HOUR_ID"/>
        </result>
    </query>
    <operation name="getLatestProxyStatHourlySummaryHourId">
        <call-query href="getLatestProxyStatHourlySummaryHourIdQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="proxyName" query-param="proxyName"/>
            <with-param name="direction" query-param="direction"/>
        </call-query>
    </operation>
    
    <query id="getLatestProxyStatDailySummaryDayIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_DAY_ID FROM BAM_PROXY_STAT_DAY_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_PROXY_STAT_DAY_FACT WHERE BAM_SERVER_ID=? AND BAM_PROXY_NAME=? AND BAM_DIRECTION=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="proxyName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_DAY_ID"/>
        </result>
    </query>
    <operation name="getLatestProxyStatDailySummaryDayId">
        <call-query href="getLatestProxyStatDailySummaryDayIdQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="proxyName" query-param="proxyName"/>
            <with-param name="direction" query-param="direction"/>
        </call-query>
    </operation>

    <query id="getLatestProxyStatMonthlySummaryMonthIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_MONTH_ID FROM BAM_PROXY_STAT_MONTH_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_PROXY_STAT_MONTH_FACT WHERE BAM_SERVER_ID=? AND BAM_PROXY_NAME=? AND BAM_DIRECTION=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="proxyName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_MONTH_ID"/>
        </result>
    </query>
    <operation name="getLatestProxyStatMonthlySummaryMonthId">
        <call-query href="getLatestProxyStatMonthlySummaryMonthIdQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="proxyName" query-param="proxyName"/>
            <with-param name="direction" query-param="direction"/>
        </call-query>
    </operation>
    
    <query id="getLatestProxyStatQuarterlySummaryQuarterIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_QTR_ID FROM BAM_PROXY_STAT_QTR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_PROXY_STAT_QTR_FACT WHERE BAM_SERVER_ID=? AND BAM_PROXY_NAME=? AND BAM_DIRECTION=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="proxyName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_QTR_ID"/>
        </result>
    </query>
    <operation name="getLatestProxyStatQuarterlySummaryQuarterId">
        <call-query href="getLatestProxyStatQuarterlySummaryQuarterIdQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="proxyName" query-param="proxyName"/>
            <with-param name="direction" query-param="direction"/>
        </call-query>
    </operation>
    
    <query id="getLatestProxyStatYearlySummaryYearIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_YEAR_ID FROM BAM_PROXY_STAT_YEAR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_PROXY_STAT_YEAR_FACT WHERE BAM_SERVER_ID=? AND BAM_PROXY_NAME=? AND BAM_DIRECTION=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="proxyName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_YEAR_ID"/>
        </result>
    </query>
    <operation name="getLatestProxyStatYearlySummaryYearId">
        <call-query href="getLatestProxyStatYearlySummaryYearIdQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="proxyName" query-param="proxyName"/>
            <with-param name="direction" query-param="direction"/>
        </call-query>
    </operation>

    
<!-- summary gen for hour =============================================================== -->

    <query id="addProxyStatHourlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_PROXY_STAT_HOUR_FACT (BAM_SERVER_ID, BAM_HOUR_ID, BAM_PROXY_NAME, BAM_DIRECTION, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="hourId" sqlType="INTEGER" type=""/>
        <param name="proxyName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addProxyStatHourlySummary">
        <call-query href="addProxyStatHourlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="hourId" query-param="hourId"/>
            <with-param name="proxyName" query-param="proxyName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>    
    
<!-- summary gen for day, month, quarter and year =============================================================== -->
    
    <query id="getProxyStatDailySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_PROXY_STAT_HOUR_FACT WHERE BAM_SERVER_ID=? AND BAM_PROXY_NAME=? AND BAM_DIRECTION=? AND BAM_HOUR_ID IN (SELECT BAM_ID FROM BAM_HOUR_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="proxyName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="medSummaryStats"  rowName="medSummaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getProxyStatDailySummary">
        <call-query href="getProxyStatDailySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="proxyName" query-param="proxyName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>
    
    <query id="addProxyStatDailySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_PROXY_STAT_DAY_FACT (BAM_SERVER_ID, BAM_DAY_ID, BAM_PROXY_NAME, BAM_DIRECTION, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="dayId" sqlType="INTEGER" type=""/>
        <param name="proxyName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addProxyStatDailySummary">
        <call-query href="addProxyStatDailySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="dayId" query-param="dayId"/>
            <with-param name="proxyName" query-param="proxyName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>    

    <query id="getProxyStatMonthlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_PROXY_STAT_DAY_FACT WHERE BAM_SERVER_ID=? AND BAM_PROXY_NAME=? AND BAM_DIRECTION=? AND BAM_DAY_ID IN (SELECT BAM_ID FROM BAM_DAY_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="proxyName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="medSummaryStats"  rowName="medSummaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getProxyStatMonthlySummary">
        <call-query href="getProxyStatMonthlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="proxyName" query-param="proxyName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>
    
    <query id="addProxyStatMonthlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_PROXY_STAT_MONTH_FACT (BAM_SERVER_ID, BAM_MONTH_ID, BAM_PROXY_NAME, BAM_DIRECTION, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="monthId" sqlType="INTEGER" type=""/>
        <param name="proxyName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addProxyStatMonthlySummary">
        <call-query href="addProxyStatMonthlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="monthId" query-param="monthId"/>
            <with-param name="proxyName" query-param="proxyName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>        
    
    <query id="getProxyStatQuarterlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_PROXY_STAT_MONTH_FACT WHERE BAM_SERVER_ID=? AND BAM_PROXY_NAME=? AND BAM_DIRECTION=? AND BAM_MONTH_ID IN (SELECT BAM_ID FROM BAM_MONTH_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="proxyName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="medSummaryStats"  rowName="medSummaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getProxyStatQuarterlySummary">
        <call-query href="getProxyStatQuarterlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="proxyName" query-param="proxyName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>
    
    <query id="addProxyStatQuarterlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_PROXY_STAT_QTR_FACT (BAM_SERVER_ID, BAM_QTR_ID, BAM_PROXY_NAME, BAM_DIRECTION, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="quarterId" sqlType="INTEGER" type=""/>
        <param name="proxyName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addProxyStatQuarterlySummary">
        <call-query href="addProxyStatQuarterlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="quarterId" query-param="quarterId"/>
            <with-param name="proxyName" query-param="proxyName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>        

    <query id="getProxyStatYearlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_PROXY_STAT_QTR_FACT WHERE BAM_SERVER_ID=? AND BAM_PROXY_NAME=? AND BAM_DIRECTION=? AND BAM_QTR_ID IN (SELECT BAM_ID FROM BAM_QTR_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="proxyName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="medSummaryStats"  rowName="medSummaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getProxyStatYearlySummary">
        <call-query href="getProxyStatYearlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="proxyName" query-param="proxyName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>
    
    <query id="addProxyStatYearlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_PROXY_STAT_YEAR_FACT (BAM_SERVER_ID, BAM_YEAR_ID, BAM_PROXY_NAME, BAM_DIRECTION, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="yearId" sqlType="INTEGER" type=""/>
        <param name="proxyName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addProxyStatYearlySummary">
        <call-query href="addProxyStatYearlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="yearId" query-param="yearId"/>
            <with-param name="proxyName" query-param="proxyName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>
    

    <!-- ******************************************* -->
    <!-- *************** SEQUENCE ****************** -->
    <!-- ******************************************* -->    

    <query id="getLatestSequenceStatHourlySummaryHourIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_HOUR_ID FROM BAM_SEQUENCE_STAT_HOUR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_SEQUENCE_STAT_HOUR_FACT WHERE BAM_SERVER_ID=? AND BAM_SEQUENCE_NAME=? AND BAM_DIRECTION=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="sequenceName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_HOUR_ID"/>
        </result>
    </query>
    <operation name="getLatestSequenceStatHourlySummaryHourId">
        <call-query href="getLatestSequenceStatHourlySummaryHourIdQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="sequenceName" query-param="sequenceName"/>
            <with-param name="direction" query-param="direction"/>
        </call-query>
    </operation>
    
    <query id="getLatestSequenceStatDailySummaryDayIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_DAY_ID FROM BAM_SEQUENCE_STAT_DAY_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_SEQUENCE_STAT_DAY_FACT WHERE BAM_SERVER_ID=? AND BAM_SEQUENCE_NAME=? AND BAM_DIRECTION=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="sequenceName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_DAY_ID"/>
        </result>
    </query>
    <operation name="getLatestSequenceStatDailySummaryDayId">
        <call-query href="getLatestSequenceStatDailySummaryDayIdQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="sequenceName" query-param="sequenceName"/>
            <with-param name="direction" query-param="direction"/>
        </call-query>
    </operation>

    <query id="getLatestSequenceStatMonthlySummaryMonthIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_MONTH_ID FROM BAM_SEQUENCE_STAT_MONTH_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_SEQUENCE_STAT_MONTH_FACT WHERE BAM_SERVER_ID=? AND BAM_SEQUENCE_NAME=? AND BAM_DIRECTION=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="sequenceName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_MONTH_ID"/>
        </result>
    </query>
    <operation name="getLatestSequenceStatMonthlySummaryMonthId">
        <call-query href="getLatestSequenceStatMonthlySummaryMonthIdQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="sequenceName" query-param="sequenceName"/>
            <with-param name="direction" query-param="direction"/>
        </call-query>
    </operation>
    
    <query id="getLatestSequenceStatQuarterlySummaryQuarterIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_QTR_ID FROM BAM_SEQUENCE_STAT_QTR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_SEQUENCE_STAT_QTR_FACT WHERE BAM_SERVER_ID=? AND BAM_SEQUENCE_NAME=? AND BAM_DIRECTION=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="sequenceName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_QTR_ID"/>
        </result>
    </query>
    <operation name="getLatestSequenceStatQuarterlySummaryQuarterId">
        <call-query href="getLatestSequenceStatQuarterlySummaryQuarterIdQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="sequenceName" query-param="sequenceName"/>
            <with-param name="direction" query-param="direction"/>
        </call-query>
    </operation>
    
    <query id="getLatestSequenceStatYearlySummaryYearIdQ" useConfig="bamDataSource">
        <sql>SELECT BAM_YEAR_ID FROM BAM_SEQUENCE_STAT_YEAR_FACT WHERE BAM_ID=(SELECT MAX(BAM_ID) FROM BAM_SEQUENCE_STAT_YEAR_FACT WHERE BAM_SERVER_ID=? AND BAM_SEQUENCE_NAME=? AND BAM_DIRECTION=?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="sequenceName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <result element="summaryTimes"  rowName="summaryTime" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="summaryTime" column="BAM_YEAR_ID"/>
        </result>
    </query>
    <operation name="getLatestSequenceStatYearlySummaryYearId">
        <call-query href="getLatestSequenceStatYearlySummaryYearIdQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="sequenceName" query-param="sequenceName"/>
            <with-param name="direction" query-param="direction"/>
        </call-query>
    </operation>

    
<!-- summary gen for hour =============================================================== -->

    <query id="addSequenceStatHourlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_SEQUENCE_STAT_HOUR_FACT (BAM_SERVER_ID, BAM_HOUR_ID, BAM_SEQUENCE_NAME, BAM_DIRECTION, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="hourId" sqlType="INTEGER" type=""/>
        <param name="sequenceName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addSequenceStatHourlySummary">
        <call-query href="addSequenceStatHourlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="hourId" query-param="hourId"/>
            <with-param name="sequenceName" query-param="sequenceName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>    
    
<!-- summary gen for day, month, quarter and year =============================================================== -->
    
    <query id="getSequenceStatDailySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_SEQUENCE_STAT_HOUR_FACT WHERE BAM_SERVER_ID=? AND BAM_SEQUENCE_NAME=? AND BAM_DIRECTION=? AND BAM_HOUR_ID IN (SELECT BAM_ID FROM BAM_HOUR_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="sequenceName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="medSummaryStats"  rowName="medSummaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getSequenceStatDailySummary">
        <call-query href="getSequenceStatDailySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="sequenceName" query-param="sequenceName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>
    
    <query id="addSequenceStatDailySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_SEQUENCE_STAT_DAY_FACT (BAM_SERVER_ID, BAM_DAY_ID, BAM_SEQUENCE_NAME, BAM_DIRECTION, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="dayId" sqlType="INTEGER" type=""/>
        <param name="sequenceName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addSequenceStatDailySummary">
        <call-query href="addSequenceStatDailySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="dayId" query-param="dayId"/>
            <with-param name="sequenceName" query-param="sequenceName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>    

    <query id="getSequenceStatMonthlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_SEQUENCE_STAT_DAY_FACT WHERE BAM_SERVER_ID=? AND BAM_SEQUENCE_NAME=? AND BAM_DIRECTION=? AND BAM_DAY_ID IN (SELECT BAM_ID FROM BAM_DAY_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="sequenceName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="medSummaryStats"  rowName="medSummaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getSequenceStatMonthlySummary">
        <call-query href="getSequenceStatMonthlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="sequenceName" query-param="sequenceName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>
    
    <query id="addSequenceStatMonthlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_SEQUENCE_STAT_MONTH_FACT (BAM_SERVER_ID, BAM_MONTH_ID, BAM_SEQUENCE_NAME, BAM_DIRECTION, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="monthId" sqlType="INTEGER" type=""/>
        <param name="sequenceName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addSequenceStatMonthlySummary">
        <call-query href="addSequenceStatMonthlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="monthId" query-param="monthId"/>
            <with-param name="sequenceName" query-param="sequenceName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>        
    
    <query id="getSequenceStatQuarterlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_SEQUENCE_STAT_MONTH_FACT WHERE BAM_SERVER_ID=? AND BAM_SEQUENCE_NAME=? AND BAM_DIRECTION=? AND BAM_MONTH_ID IN (SELECT BAM_ID FROM BAM_MONTH_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="sequenceName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="medSummaryStats"  rowName="medSummaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getSequenceStatQuarterlySummary">
        <call-query href="getSequenceStatQuarterlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="sequenceName" query-param="sequenceName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>
    
    <query id="addSequenceStatQuarterlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_SEQUENCE_STAT_QTR_FACT (BAM_SERVER_ID, BAM_QTR_ID, BAM_SEQUENCE_NAME, BAM_DIRECTION, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="quarterId" sqlType="INTEGER" type=""/>
        <param name="sequenceName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addSequenceStatQuarterlySummary">
        <call-query href="addSequenceStatQuarterlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="quarterId" query-param="quarterId"/>
            <with-param name="sequenceName" query-param="sequenceName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>        

    <query id="getSequenceStatYearlySummaryQ" useConfig="bamDataSource">
        <sql>SELECT AVG(BAM_AVG_RES_TIME) AS AVG_RES, MAX(BAM_MAX_RES_TIME) AS MAX_RES, MIN(BAM_MIN_RES_TIME) AS MIN_RES, SUM(BAM_REQ_COUNT) AS REQ_COUNT, SUM(BAM_FAULT_COUNT) AS FAULT_COUNT FROM  BAM_SEQUENCE_STAT_QTR_FACT WHERE BAM_SERVER_ID=? AND BAM_SEQUENCE_NAME=? AND BAM_DIRECTION=? AND BAM_QTR_ID IN (SELECT BAM_ID FROM BAM_QTR_DIM WHERE BAM_START_TIMESTAMP &gt;= ? AND BAM_START_TIMESTAMP &lt; ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="sequenceName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="startTimestamp" sqlType="TIMESTAMP" type=""/>
        <param name="endTimestamp" sqlType="TIMESTAMP" type=""/>
        <result element="medSummaryStats"  rowName="medSummaryStat" defaultNamespace="http://bam.carbon.wso2.org">
            <element name="avgResTime" column="AVG_RES"/>
            <element name="maxResTime" column="MAX_RES"/>
            <element name="minResTime" column="MIN_RES"/>
            <element name="reqCount" column="REQ_COUNT"/>
            <element name="faultCount" column="FAULT_COUNT"/>
        </result>
    </query>
    <operation name="getSequenceStatYearlySummary">
        <call-query href="getSequenceStatYearlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="sequenceName" query-param="sequenceName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="startTimestamp" query-param="startTimestamp"/>
            <with-param name="endTimestamp" query-param="endTimestamp"/>
        </call-query>
    </operation>
    
    <query id="addSequenceStatYearlySummaryQ" useConfig="bamDataSource">
        <sql>INSERT INTO BAM_SEQUENCE_STAT_YEAR_FACT (BAM_SERVER_ID, BAM_YEAR_ID, BAM_SEQUENCE_NAME, BAM_DIRECTION, BAM_AVG_RES_TIME, BAM_MAX_RES_TIME, BAM_MIN_RES_TIME, BAM_REQ_COUNT, BAM_FAULT_COUNT) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)</sql>
        <param name="serverId" sqlType="INTEGER" type=""/>
        <param name="yearId" sqlType="INTEGER" type=""/>
        <param name="sequenceName" sqlType="STRING" type=""/>
        <param name="direction" sqlType="STRING" type=""/>
        <param name="avgResTime" sqlType="DOUBLE" type=""/>
        <param name="maxResTime" sqlType="DOUBLE" type=""/>
        <param name="minResTime" sqlType="DOUBLE" type=""/>
        <param name="reqCount" sqlType="INTEGER" type=""/>
        <param name="faultCount" sqlType="INTEGER" type=""/>
    </query>
    <operation name="addSequenceStatYearlySummary">
        <call-query href="addSequenceStatYearlySummaryQ">
            <with-param name="serverId" query-param="serverId"/>
            <with-param name="yearId" query-param="yearId"/>
            <with-param name="sequenceName" query-param="sequenceName"/>
            <with-param name="direction" query-param="direction"/>
            <with-param name="avgResTime" query-param="avgResTime"/>
            <with-param name="maxResTime" query-param="maxResTime"/>
            <with-param name="minResTime" query-param="minResTime"/>
            <with-param name="reqCount" query-param="reqCount"/>
            <with-param name="faultCount" query-param="faultCount"/>
        </call-query>
    </operation>
    
<!--    
SELECT T1.BAM_TIMESTAMP, T1.BAM_VALUE, T2.BAM_VALUE, T3.BAM_VALUE, T4.BAM_VALUE, T5.BAM_VALUE FROM (SELECT BAM_TIMESTAMP, BAM_VALUE FROM BAM_SERVER_USER_DATA WHERE BAM_KEY LIKE ?) AS T1, (SELECT BAM_TIMESTAMP, BAM_VALUE FROM BAM_SERVER_USER_DATA WHERE BAM_KEY LIKE ?) AS T2, (SELECT BAM_TIMESTAMP , BAM_VALUE FROM BAM_SERVER_USER_DATA WHERE BAM_KEY LIKE ?) AS T3, (SELECT BAM_TIMESTAMP, BAM_VALUE FROM BAM_SERVER_USER_DATA WHERE BAM_KEY LIKE ?) AS T4, (SELECT BAM_KEY, BAM_TIMESTAMP , BAM_VALUE FROM BAM_SERVER_USER_DATA WHERE BAM_KEY LIKE ?) AS T5 WHERE T1.BAM_TIMESTAMP = T2.BAM_TIMESTAMP AND T1.BAM_TIMESTAMP = T3.BAM_TIMESTAMP AND T1.BAM_TIMESTAMP = T4.BAM_TIMESTAMP AND T1.BAM_TIMESTAMP = T5.BAM_TIMESTAMP AND T1.BAM_TIMESTAMP  &gt;=? AND T1.BAM_TIMESTAMP &lt;=?
-->

</data>

<analyzerSequence name="ProductSummarizer">    
   <trigger cron="1 * * * * ? *"/>    
   <analyzers>        
      <get name="BASE" batchSize="3"/>        
      <extract>            
         <field from="in_message_body" name="item" xpath="//m:placeOrder/m:order/x:itemCode">                
            <namespace prefix="m" uri="http://order.sample"/>                
            <namespace prefix="x" uri="http://order.sample/xsd"/>            
         </field>        
      </extract>        
      <extract>            
         <field from="in_message_body" name="quantity" xpath="//m:placeOrder/m:order/x:quantity">                
            <namespace prefix="m" uri="http://order.sample"/>                
            <namespace prefix="x" uri="http://order.sample/xsd"/>            
         </field>        
      </extract>        
      <groupBy>            
         <field name="item"/>        
      </groupBy>        
      <drop type="column">            
         <fieldSet>                
            <field name="bam_activity_id"/>                
            <field name="in_message_body"/>                
            <field name="correlationKey1"/>                
            <field name="correlationKey2"/>                
            <field name="correlationKey3"/>                
            <field name="metaKey1"/>                
            <field name="metaKey2"/>                
            <field name="metaKey3"/>                
            <field name="timestamp"/>            
         </fieldSet>        
      </drop>        
      <aggregate>            
         <measure name="quantity" aggregationType="SUM"/>        
      </aggregate>        
      <put name="productSummary" dataSourceType="CASSANDRA">            
         <onExist>                
            <aggregate>                    
               <measure name="quantity" aggregationType="SUM"/>                
            </aggregate>            
         </onExist>        
      </put>        
      <get name="productSummary"/>        
      <log/>    
   </analyzers>
</analyzerSequence>
